<!--
  Generated template for the CurrentTripPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <navigation></navigation>
</ion-header>


<ion-content>
  <div class="upperPart">
    <button ion-button round icon-only id="swapButton" (click)="toggleMapAndCamera()">
      <ion-icon name="swap"></ion-icon>
    </button>

    <div class="myMap" [hidden]="!showMap">
      <agm-map [latitude]="myLocation.lat" [longitude]="myLocation.long" [zoom]="myMap.zoom">
        <agm-marker [latitude]="myLocation.lat" [longitude]="myLocation.long">
        </agm-marker>
      </agm-map>
    </div>

    <div class="canvasContainer" [hidden]="showMap">
      <canvas #canvas playsinline autoplay (window:resize)="onResize($event)"></canvas>
    </div>

  </div>

  <!--
    <div class="bottomPart" *ngFor="let step of connection.legs; let lst = last; let i = index">
  -->
  <div class="bottomPart" *ngIf="currentLeg">
    <button ion-button (click)="add1Minute()"> +1 Minute</button>
    <ion-card>
      <ion-row class="currentStop" (click)="togglePassedStations()" justify-content-between *ngIf="stepList.length > 1">
        <ion-col col-auto>
          <ion-row>
            <ion-col>
              <ion-note>NÃ¤chster Halt:</ion-note>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="stepList.length > 1">
            <ion-col col-auto="">
              {{getVVBTime(stepList[0].departure)}} Uhr
            </ion-col>
            <ion-col>
              {{stepList[0].station.name}}
            </ion-col>
          </ion-row>
          <ion-row *ngIf="stepList.length < 1">
            <ion-col col-auto="">
              {{getVVBTime(currentLeg.arrival)}} Uhr
            </ion-col>
            <ion-col>
              {{currentLeg.destination.name}}
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col col-2 align-self-end *ngIf="stepList.length > 2">
          <button ion-button round icon-only clear color="primary">
            <ion-icon name="{{passedStations? 'ios-arrow-down' : 'ios-arrow-up' }}"></ion-icon>
          </button>
        </ion-col>

      </ion-row>

      <ion-row class="nextStops" *ngIf="stepList.length > 2 && passedStations">
        <ion-col col-12 *ngFor="let step of stepList; first as frst; last as lst;">
          <ion-row *ngIf="!frst && !lst">
            <ion-col col-auto>
              {{getVVBTime(step.departure)}} Uhr
            </ion-col>
            <ion-col>
              {{step.station.name}}
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>

      <ion-row class="arrivalStop">

        <ion-col col-12 class="arrivalRow">

          <ion-row>
            <ion-col col-3>
              <ion-note>Ankunft:</ion-note>
            </ion-col>
            <ion-col col-2>
              <ion-note>Gleis</ion-note>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col col-3>
              {{getVVBTime(currentLeg.arrival)}} Uhr
            </ion-col>
            <ion-col col-1>
              {{currentLeg.arrivalPlatform? currentLeg.arrivalPlatform : "?" }}
            </ion-col>
            <ion-col>
              {{currentLeg.destination.name}}
            </ion-col>
          </ion-row>

        </ion-col>

        <ion-col col-12 *ngIf="connection.legs.length > 1 && nextLeg" class="arrivalRow">
          <ion-row>
            <ion-col col-3>
              <ion-note>Abfahrt:</ion-note>
            </ion-col>
            <ion-col col-2>
              <ion-note>Gleis</ion-note>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col col-3>
              {{getVVBTime(nextLeg.departure)}} Uhr
            </ion-col>
            <ion-col col-1>
              {{nextLeg.departurePlatform? nextLeg.departurePlatform : "?" }}
            </ion-col>
            <ion-col>
              {{nextLeg.origin.name}}
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>

    </ion-card>

  </div>

</ion-content>
